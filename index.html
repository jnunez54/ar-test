<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AR Marker Images - Corregido</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  </head>

  <body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">

      <a-assets>
        <img id="img1" src="imgs/1.png">
        <img id="img2" src="imgs/2.png">
        <img id="img3" src="imgs/3.png">
        <img id="img4" src="imgs/4.png">

        <audio id="audio1" src="audio/1.mp3"></audio>
        <audio id="audio2" src="audio/2.mp3"></audio>
        <audio id="audio3" src="audio/3.mp3"></audio>
        <audio id="audio4" src="audio/4.mp3"></audio>

        <a-asset-item id="charModel" src="models/fox.gltf"></a-asset-item>
      </a-assets>

      <!-- Marker 1 -->
      <a-marker id="marker1" type="pattern" url="markers/1.patt">
        <a-plane
          src="#img1"
          width="1.5"
          height="1.5"
          position="-.75 1 0"
          rotation="0 0 0">
        </a-plane>

        <a-entity
          id="model1"
          gltf-model="#charModel"
          position="0.75 0.5 0"
          rotation="-90 0 0"
          scale="0.5 0.5 0.5"
          animation-mixer>
        </a-entity>
      </a-marker>

      <!-- Marker 2 -->
      <a-marker id="marker2" type="pattern" url="markers/2.patt">
        <a-plane
          src="#img2"
          width="1.5"
          height="1.5"
          position="-.75 1 0"
          rotation="0 0 0">
        </a-plane>

        <a-entity
          id="model2"
          gltf-model="#charModel"
          position="0.75 0.5 0"
          rotation="-90 0 0"
          scale="0.5 0.5 0.5"
          animation-mixer>
        </a-entity>
      </a-marker>

      <!-- Marker 3 -->
      <a-marker id="marker3" type="pattern" url="markers/3.patt">
        <a-plane
          src="#img3"
          width="1.5"
          height="1.5"
          position="-.75 1 0"
          rotation="0 0 0">
        </a-plane>

        <a-entity
          id="model3"
          gltf-model="#charModel"
          position="0.75 0.5 0"
          rotation="-90 0 0"
          scale="0.5 0.5 0.5"
          animation-mixer>
        </a-entity>
      </a-marker>

      <!-- Marker 4 -->
      <a-marker id="marker4" type="pattern" url="markers/4.patt">
        <a-plane
          src="#img4"
          width="1.5"
          height="1.5"
          position="-.75 1 0"
          rotation="0 0 0">
        </a-plane>

        <a-entity
          id="model4"
          gltf-model="#charModel"
          position="0.75 0.5 0"
          rotation="-90 0 0"
          scale="0.5 0.5 0.5"
          animation-mixer>
        </a-entity>
      </a-marker>

    </a-scene>

    <script>
      // ConfiguraciÃ³n optimizada para todos los marcadores
      document.addEventListener('DOMContentLoaded', () => {
        // Configurar para cada marcador
        for (let i = 1; i <= 4; i++) {
          const marker = document.querySelector(`#marker${i}`);
          const audio = document.querySelector(`#audio${i}`);
          const model = document.querySelector(`#model${i}`);

          let isPlaying = false;

          marker.addEventListener('markerFound', () => {
            console.log(`Marker ${i} detectado`);
            if (!isPlaying) {
              audio.currentTime = 0;
              audio.play().catch(err => {
                console.warn(`No se pudo reproducir el audio ${i}:`, err);
              });
              isPlaying = true;
            }
          });

          marker.addEventListener('markerLost', () => {
            console.log(`Marker ${i} perdido`);
            audio.pause();
            audio.currentTime = 0;
            isPlaying = false;
          });
        }
      });
    </script>
  </body>
</html>